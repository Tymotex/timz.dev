---
title: Server-Side Request Forgery
description: SSRF is about you, as an attacker, getting a server to fulfill network requests that you don’t have authorisation for
published: true
date: 2022-06-25
---

SSRF is about you, as an attacker, getting a server to fulfill network requests that you don’t have authorisation for. Many web application backends will involve getting a URL input from the user and using the user-supplied URL to fulfil some request, like fetching its contents and returning it. The problem arises when the server is given a URL that references an internal service or other services that the server has priveleged access to, like a database server. An attacker could send an `http://localhost` URL at a specific port that’s running a confidential internal service, or you could send something like `file:///etc/passwd/` and leak resources on the web server. 

![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/9d233682-0cd7-4701-85ee-840afbf7b0d8/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220410%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220410T010510Z&X-Amz-Expires=86400&X-Amz-Signature=c8f8e2762926949a83f2039434ebd1df12b43f88ba17ae2fab6e8a5e56e6e4f2&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)

We call this server-side request forgery because we’re making malicious requests and passing it off to the server and getting them to make that request for us.

As an attacker, if you get to input the specific port of the URL you pass in, you’ll basically be able to port scan the entire internal network of the web server and map out its network infrastructure. This is called a *cross site port attack* *(XSPA)*.

**Defending against SSRF:**

SSRF is challenging to defend against. Just like for SQL injections, a main defense strategy is sanitising the input. A good first step to securing the backend server against SSRF attacks is to whitelist only the URLs that have a target port of 80 (HTTP traffic) or 443 (HTTPS traffic) to prevent *port scanning* and deny using all other URLs. We can also disallow any given URL whose protocol is not HTTP or HTTPS, meaning something like `file:///etc/passwd/` won’t work.
